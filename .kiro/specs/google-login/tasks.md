# 구글 로그인 기능 구현 계획

- [x] 1. Supabase 클라이언트 설정 수정 및 최적화
  - 기존 `web/lib/supabase.ts` 파일 분석 및 문제점 식별
  - 환경 변수 기반 설정으로 변경
  - 브라우저 클라이언트 OAuth 설정 최적화 (PKCE, 세션 관리)
  - TypeScript 타입 정의 개선
  - _요구사항: 3.1, 3.2, 3.3_

- [x] 2. OAuth 버튼 컴포넌트 개선
  - 기존 `web/components/oauth-buttons.tsx` 분석 및 수정
  - TypeScript 인터페이스 정의 (props, 상태)
  - 오류 처리 로직 강화 및 사용자 친화적 메시지
  - 로딩 상태 시각적 피드백 구현
  - Tailwind CSS 스타일링 개선 
  - 접근성 (ARIA) 속성 추가
  - _요구사항: 1.1, 4.1, 4.3_

- [x] 3. OAuth 콜백 페이지 구현
  - `web/app/auth/callback/page.tsx` 신규 생성
  - URL 파라미터에서 인증 정보 추출 로직
  - Supabase 세션 설정 및 검증
  - 성공/실패 상태별 사용자 피드백 UI
  - 리디렉션 로직 구현 (대시보드 또는 지정된 경로)
  - 오류 상황 처리 및 로그인 페이지 복귀
  - _요구사항: 1.2, 4.1, 4.4, 5.1_

- [ ] 4. 인증 컨텍스트 프로바이더 개선
  - 기존 `web/components/auth-provider.tsx` 분석 및 수정
  - React Context API를 사용한 전역 인증 상태 관리
  - TypeScript 타입 정의 (AuthContextType, User, Session)
  - 초기 세션 로딩 및 상태 관리
  - 인증 상태 변경 리스너 구현
  - 자동 토큰 갱신 처리
  - 로그아웃 기능 구현
  - _요구사항: 5.1, 5.2, 5.3, 5.4_

- [ ] 5. 로그인 페이지 통합 및 개선
  - 기존 `web/app/auth/login/page.tsx` 수정
  - 개선된 OAuth 버튼 컴포넌트 통합
  - 오류 상태 표시 개선
  - 로딩 상태 처리
  - 교사 사용자를 위한 UI/UX 최적화
  - _요구사항: 1.1, 4.1, 4.3_

- [x] 6. 미들웨어 인증 로직 수정
  - 기존 `web/middleware.ts` 분석 및 수정
  - 인증 상태 확인 로직 구현
  - 보호된 라우트 설정 (/dashboard, /students 등)
  - 적절한 리디렉션 로직 (로그인 페이지 ↔ 대시보드)
  - 콜백 페이지 접근 허용 설정
  - _요구사항: 1.2, 5.1_

- [ ] 7. 오류 페이지 구현
  - `web/app/auth/error/page.tsx` 신규 생성
  - 인증 오류 상황별 메시지 표시
  - 재시도 옵션 제공
  - 로그인 페이지로 돌아가기 기능
  - 교사 사용자를 위한 명확한 안내
  - _요구사항: 4.1, 4.2, 4.4_

- [ ] 8. 환경 변수 설정 및 문서화
  - 필요한 환경 변수 목록 정리
  - `.env.example` 파일 생성 또는 업데이트
  - 개발/프로덕션 환경별 설정 가이드 작성
  - Supabase 프로젝트 설정 요구사항 문서화
  - _요구사항: 3.2_

- [ ] 9. 단위 테스트 작성
  - OAuth 버튼 컴포넌트 테스트 (`web/components/__tests__/oauth-buttons.test.tsx`)
  - 인증 컨텍스트 프로바이더 테스트
  - Supabase 클라이언트 설정 테스트
  - 콜백 페이지 로직 테스트
  - Jest 설정 확인 및 테스트 실행
  - _요구사항: 모든 요구사항의 검증_

- [ ] 10. 통합 테스트 및 최종 검증
  - 전체 구글 로그인 플로우 테스트
  - 오류 시나리오 테스트 (네트워크 오류, 인증 취소 등)
  - 세션 관리 테스트 (페이지 새로고침, 토큰 갱신)
  - 다양한 브라우저에서 동작 확인
  - 모바일 반응형 테스트
  - 접근성 테스트
  - _요구사항: 모든 요구사항의 최종 검증_